/*
 * @Author: LXK9301 https://github.com/LXK9301
 * @Date: 2020-11-27 09:19:21
 * @Last Modified by: LXK9301
 * @Last Modified time: 2021-1-1 16:58:02
 */
/*

赚豆脚本，一周签到下来可获得30京豆，一天任意时刻运行一次即可
活动入口：赚京豆(微信小程序)-赚京豆-签到领京豆
更新地址：https://gitee.com/lxk0301/jd_scripts/raw/master/jd_syj.js
参考github@jidesheng6修改而来
TED演讲：是什么造就了长城的无与伦比
文章来源：未知 文章作者：enread 发布时间：2020-04-02 08:42 字体： [大 中 小]　 进入论坛
(单词翻译:双击或拖选)
TED演讲：是什么造就了长城的无与伦比，好好学习下，下次向外国朋友介绍的长城的话就不会没有话说了。
A 13,000 mile dragon of earth and stone winds its way through the countryside of China 一条1万3英里的土石之龙蜿蜒于中国乡野之间，
with a history almost as long and serpentine1 as the structure. 它的历史几乎与其结构一样悠久曲折。
The Great Wall began as multiple walls of rammed2 earth built by individual feudal3 states during the Chunqiu period 长城最初是多座泥土夯实的城墙，由春秋战国时期的各个独立封建国家修筑，
to protect against nomadic4 raiders north of China and each other. 以抵制中国北方游牧民和其它国家。
When Emperor Qin Shi Huang unified5 the states in 221 BCE, 公元前221年，秦始皇统一中国时，
the Tibetan Plateau and Pacific Ocean became natural barriers, 青藏高原和太平洋成为了国家的天然屏障，
but the mountains in the north remained vulnerable to Mongol, Turkish, and Xiongnu invasions. 但北方的山脉对于蒙古、土耳其及匈奴人的入侵来说显得非常薄弱。
To defend against them, the Emperor expanded the small walls built by his predecessors6, 为了抵御外敌，秦始皇扩建了之前所筑建的小城墙，
connecting some and fortifying7 others. 把它们巩固强化并加以连接。
As the structures grew from Lintao in the west to Liaodong in the east, 城墙起于西部临洮，止于东部辽东，
they collectively became known as The Long Wall. 合在一起称为长城。
To accomplish this task, the Emperor enlisted8 soldiers and commoners, not always voluntarily. 为了完成这项工程，秦始皇征召了士兵和平民，而他们往往不是出于自愿。
Of the hundreds of thousands of builders recorded during the Qin Dynasty, 在秦朝记录的成千上万建造者中，
many were forcibly conscripted peasants and others were criminals serving out sentences. 许多人都是被强征而去的农民，另外一些则是服刑犯人。
Under the Han Dynasty, the wall grew longer still, reaching 3700 miles, 汉朝时期，长城继续扩建延长至3700英里，
and spanning from Dunhuang to the Bohai Sea. 从敦煌延伸到渤海。
Forced labor9 continued under the Han Emperor Han-Wudi,  强制性劳动在汉武帝时期持续着，
and the walls reputation grew into a notorious place of suffering. 因而城墙被视作受苦受害之地，从而臭名昭彰。
Poems and legends of the time told of laborers10 buried in nearby mass graves, or even within the wall itself. 那一时期的诗歌与传说描述了劳动者被掩埋于附近的大规模墓地甚至是城墙内。
And while no human remains11 have been found inside, grave pits do 然而城墙内并未发现人类尸骸墓坑，
indicate that many workers died from accidents, hunger and exhaustion12. 表明那些劳动者大多死于意外、饥饿与疲劳。
The wall was formidable but not invincible13. 长城令人生畏却非不可战胜。
Both Genghis and his son Khublai Khan managed to surmount14 the wall during the Mongol invasion of the 13th Century. 成吉思汗和他的儿子忽必烈曾于13世纪蒙古侵入之际设法攻克城墙。
After the Ming dynasty gained control in 1368, 1368年明朝执政之后，
they began to refortify and further consolidate15 the wall using bricks and stones from local kilns16. 他们开始使用当地窑中烧制而成的砖与石头重新强化和加固长城。
Averaging 23 feet high and 21 feet wide, the walls 5500 miles were punctuated17 by watchtowers. 长城平均高7米，宽6米，5500英里的城墙中间隔着瞭望台。
When raiders were sighted, fire and smoke signals traveled between towers until reinforcements arrived. 一旦看到有侵入者，瞭望台之间便会用升起的狼烟与风火传递信号，直到援兵抵达。
Small openings along the wall let archers18 fire on invaders19, 城墙上的小孔让弓箭手能够射击侵入者，
while larger ones were used to drop stones and more. 而大孔则用于投掷石头或者其它东西。
But even this new and improved wall was not enough. 但即便是这种全新改进的城墙仍然不够好。
In 1644, northern Manchu clans20 overthrew21 the Ming to establish the Qing dynasty, incorporating Mongolia as well, 1644年，北方满族推翻明朝建立清朝，同时合并了蒙古。
Thus, for the second time, China was ruled by the very people the wall had tried to keep out. 因此，这是中国第二次被城墙抵御的外族统治。
With the empire's borders now extending beyond the Great Wall, the fortifications lost their purpose. 随着帝国边界扩展到长城以外，这些工事失去了原本的目的。
And without regular reinforcement, the wall fell into disrepair, rammed earth eroded22, 没有了定期加固，城墙失修破损，夯土被侵蚀，
while brick and stone were plundered23 for building materials. But its job wasn't finished. 砖和石头则被盗窃用作建筑材料，但是长城的使命仍未结束。
During World War II, China used sections for defense24 against Japanese invasion, 第二次世界大战期间，中国用部分城墙来抵御日本侵略，
and some parts are still rumored25 to be used for military training. 一部分城墙仍然被盛传用于军事训练。
But the Wall's main purpose today is cultural. 然而今日，文化才是长城的主要目的。
As one of the largest man-made structures on Earth, 作为地球上大型人工建筑之一，
it was granted UNESCO World Heritage Status in 1987. 长城于1987年被联合国教科文组织列为世界文化遗产。
Originally built to keep people out of China, the Great Wall now welcomes millions of visitors each year. 长城起初建造用于防御外人进入中国，如今每年都会迎接数百万游客。
In fact, the influx26 of tourists has caused the wall to deteriorate27, 实际上，大量涌入的游客已导致长城日益损坏，
leading the Chinese government to launch preservation28 initiatives. 致使中国政府启动保护措施。
It's also often acclaimed29 as the only man-made structure visible from space. 它也经常被宣称为唯一一处可自太空看见的人造建筑。
Unfortunately, that's not at all true. 不幸的是，这种说法不完全正确。
In low Earth orbit, all sorts of structures, like bridges, highways and airports are visible, 在地球低轨道上，各种建筑物如桥梁、高速公路以及机场均可看见，
and the Great Wall is only barely discernible. 而长城却若隐若现。
From the moon, it doesn't stand a chance. 从月球上，它则一点也看不到。
But regardless, it's the Earth we should be studying it from because new sections are still discovered every few years,  但无论如何，地球才是我们应该好好研究长城的地方，因为每隔几年都会有新的部分被发现，
branching off from the main body and expanding this remarkable30 monument to human achievement. 它们从主体部分扩展开去，不断延伸着这见证人类成就的伟大奇迹。

============Quantumultx===============
[task_local]
#赚京豆
10 7 * * * https://gitee.com/lxk0301/jd_scripts/raw/master/jd_syj.js, tag=赚京豆, img-url=https://raw.githubusercontent.com/58xinian/icon/master/jd_syj.png, enabled=true

================Loon==============
[Script]
cron "10 7 * * *" script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_syj.js, tag=赚京豆

===============Surge=================
赚京豆 = type=cron,cronexp="10 7 * * *",wake-system=1,timeout=3600,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_syj.js

============小火箭=========
赚京豆 = type=cron,script-path=https://gitee.com/lxk0301/jd_scripts/raw/master/jd_syj.js, cronexpr="10 7 * * *", timeout=3600, enable=true
 */
const $ = new Env('赚京豆');

const notify = $.isNode() ? require('./sendNotify') : '';
//Node.js用户请在jdCookie.js处填写京东ck;
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
let jdNotify = true;//是否关闭通知，false打开通知推送，true关闭通知推送
const randomCount = $.isNode() ? 20 : 5;
//IOS等用户直接用NobyDa的jd cookie
let cookiesArr = [], cookie = '', message;
if ($.isNode()) {
  Object.keys(jdCookieNode).forEach((item) => {
    cookiesArr.push(jdCookieNode[item])
  })
  if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => {};
} else {
  let cookiesData = $.getdata('CookiesJD') || "[]";
  cookiesData = jsonParse(cookiesData);
  cookiesArr = cookiesData.map(item => item.cookie);
  cookiesArr.reverse();
  cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
  cookiesArr.reverse();
  cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
}
const JD_API_HOST = 'https://api.m.jd.com/api';
!(async () => {
  if (!cookiesArr[0]) {
    $.msg($.name, '【提示】请先获取京东账号一cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/bean/signIndex.action', {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});
    return;
  }
  for (let i = 0; i < cookiesArr.length; i++) {
    if (cookiesArr[i]) {
      cookie = cookiesArr[i];
      $.UserName = decodeURIComponent(cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_pin=(.+?);/)[1])
      $.index = i + 1;
      $.isLogin = true;
      $.nickName = '';
      message = '';
      await TotalBean();
      console.log(`\n******开始【京东账号${$.index}】${$.nickName || $.UserName}*********\n`);
      if (!$.isLogin) {
        $.msg($.name, `【提示】cookie已失效`, `京东账号${$.index} ${$.nickName || $.UserName}\n请重新登录获取\nhttps://bean.m.jd.com/bean/signIndex.action`, {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});

        if ($.isNode()) {
          await notify.sendNotify(`${$.name}cookie已失效 - ${$.UserName}`, `京东账号${$.index} ${$.UserName}\n请重新登录获取cookie`);
        }
        continue
      }
      await userSignIn();
      await showMsg();
    }
  }
})()
    .catch((e) => {
      $.log('', `❌ ${$.name}, 失败! 原因: ${e}!`, '')
    })
    .finally(() => {
      $.done();
    })

function showMsg() {
  return new Promise(resolve => {
    $.msg($.name, '', `【京东账号${$.index}】${$.nickName}\n${message}`);
    resolve()
  })
}
let signFlag = 0;
function userSignIn() {
  return new Promise(resolve => {
    const body = {"activityId":"ccd8067defcd4787871b7f0c96fcbf5c","inviterId":"","channel":"MiniProgram"};
    $.get(taskUrl('userSignIn', body), async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (safeGet(data)) {
            data = JSON.parse(data);
            if (data.code === 0) {
              signFlag = 0;
              console.log(`${$.name}今日签到成功`);
              if (data.data) {
                let { alreadySignDays, beanTotalNum, todayPrize, eachDayPrize } = data.data;
                message += `【第${alreadySignDays}日签到】成功，获得${todayPrize.beanAmount}京豆 🐶\n`;
                if (alreadySignDays === 7) alreadySignDays = 0;
                message += `【明日签到】可获得${eachDayPrize[alreadySignDays].beanAmount}京豆 🐶\n`;
                message += `【累计获得】${beanTotalNum}京豆 🐶\n`;
              }
            } else if (data.code === 81) {
              console.log(`今日已签到`)
              message += `【签到】失败，今日已签到`;
            } else if (data.code === 6) {
              //此处有时会遇到 服务器繁忙 导致签到失败,故重复三次签到
              $.log(`${$.name}签到失败${signFlag}:${data.msg}`);
              if (signFlag < 3) {
                signFlag ++;
                await userSignIn();
              }
            } else if (data.code === 66) {
              //此处有时会遇到 服务器繁忙 导致签到失败,故重复三次签到
              $.log(`${$.name}签到失败:${data.msg}`);
              message += `【签到】失败，${data.msg}`;
            } else {
              console.log(`异常：${JSON.stringify(data)}`)
            }
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function taskUrl(function_id, body = {}) {
  return {
    url: `${JD_API_HOST}?functionId=${function_id}&body=${escape(JSON.stringify(body))}&appid=swat_miniprogram&osVersion=5.0.0&clientVersion=3.1.3&fromType=wxapp&timestamp=${new Date().getTime() + new Date().getTimezoneOffset()*60*1000 + 8*60*60*1000}`,
    headers: {
      "Accept": "*/*",
      "Accept-Encoding": "gzip, deflate, br",
      "Accept-Language": "zh-cn",
      "Connection": "keep-alive",
      "Content-Type": "application/x-www-form-urlencoded",
      "Host": "api.m.jd.com",
      "Referer": "https://servicewechat.com/wxa5bf5ee667d91626/108/page-frame.html",
      "Cookie": cookie,
      "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0"),
    }
  }
}
function TotalBean() {
  return new Promise(async resolve => {
    const options = {
      "url": `https://wq.jd.com/user/info/QueryJDUserInfo?sceneval=2`,
      "headers": {
        "Accept": "application/json,text/plain, */*",
        "Content-Type": "application/x-www-form-urlencoded",
        "Accept-Encoding": "gzip, deflate, br",
        "Accept-Language": "zh-cn",
        "Connection": "keep-alive",
        "Cookie": cookie,
        "Referer": "https://wqs.jd.com/my/jingdou/my.shtml?sceneval=2",
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.post(options, (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (data) {
            data = JSON.parse(data);
            if (data['retcode'] === 13) {
              $.isLogin = false; //cookie过期
              return
            }
            $.nickName = data['base'].nickname;
          } else {
            console.log(`京东服务器返回空数据`)
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function safeGet(data) {
  try {
    if (typeof JSON.parse(data) == "object") {
      return true;
    }
  } catch (e) {
    console.log(e);
    console.log(`京东服务器访问数据为空，请检查自身设备网络情况`);
    return false;
  }
}
function jsonParse(str) {
  if (typeof str == "string") {
    try {
      return JSON.parse(str);
    } catch (e) {
      console.log(e);
      $.msg($.name, '', '请勿随意在BoxJs输入框修改内容\n建议通过脚本去获取cookie')
      return [];
    }
  }
}
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
