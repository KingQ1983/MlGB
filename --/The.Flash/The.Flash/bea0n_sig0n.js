/*
 * @Author: LXK9301 https://github.com/LXK9301
 */
/*
拉加德2015伊利诺伊理工大学毕业演讲
文章来源：未知 文章作者：enread 发布时间：2020-07-29 09:28 字体： [大 中 小]　 进入论坛
(单词翻译:双击或拖选)
Well, good morning to all of you.
各位早上好。
And let me, first of all, congratulate what you have demonstrated right now an agility in transforming yourself.
首先，请允许我对你们在改造自己的过程中所表现出的敏捷性表示祝贺。
You looked a little bit dark, a little bit gray.
你们看起来有点暗，有点灰。
You look fantastically transparent and full of beautiful umbrellas in the back.
你们看起来非常透明，背后还有很多漂亮的雨伞。
And thank you chairman for introducing the rain.
另外还要感谢主持人介绍下雨。
It is a great honor to return to IIT and celebrate together.
很荣幸回到伊利诺伊理工大学和各位一起庆祝。
I would like to thank President Anderson for his kind invitation.
我要感谢安德逊校长的诚挚邀请。
To thank faculty members, board members, students, parents, grandparents, family members.
要感谢各位教职员工、董事会成员、学生、各位父母、祖父母和家人。
And I would like to thank you for your patience and warm welcome.
还要感谢你们的耐心和热情欢迎。
Let me start with a full disclosure.
接下来我要从一个充分披露开始。
Back many years ago, I was indeed a member of the international advisory council of IIT,
许多年前，我确实是伊利诺伊理工大学国际咨询委员会的成员，
but this is not the reason why I want to disclose fully.
但这不是我想充分披露的原因。
Fully disclosure of my highly personal interest in today's ceremony.
充分披露我个人对今天典礼的最高热情。
I am the proud mother of one of the 2,591 graduates whose accomplishments are being recognized today.
我是一位自豪的母亲，我的孩子也是今天被认可的2591名优异毕业生中的一员。
And as an immensely proud mum... as an immensely proud mum,
作为一位非常自豪的母亲...作为一位非常自豪的母亲，
I would like to extend a special welcome to all families and friends who are joining this wonderful commencement exercise.
我要特别欢迎所有参加这次精彩毕业典礼的家人和朋友。
It's a joyous moment for all of us.
这是我们所有人的快乐时光。
And today, the center of our universe is right here in Chicago, on the Ed Glancy Field.
今天，我们整个世界的中心就在这里，芝加哥埃德葛兰西球场。
Today you, the graduates of this great university, have the right to feel like the new masters of the academic universe.
今天，你们，这所伟大学校的毕业生们，有权利认为自己就是学术界的新大师。
Hard work, boundless energy, relentless curiosity, and incredible talent:
刻苦的工作，无穷的能量，无尽的好奇心，了不起的天赋：
these are some of the qualities that helped you achieve success in the classroom.
这些是帮助你在课堂上取得成功的一些品质。
And these are the same qualities that will help you achieve success
这些品质同样会帮助你获得成功，
and that will bring to bear on some of the world's most exciting challenges.
可以用来迎接全世界最让人激动的挑战。
And believe me, there are plenty of those.
相信我，有很多这样的挑战。
In other words, after having written the prologue,
换句话说，写完了序言之后，
you are now ready to draft your 21st-century legacies in engineering, architecture, business, design, science and technology, and law.
你们现在准备草拟自己21世纪的工程、建筑、商业、设计、科学技术、法律领域的遗产。
What an incredible privilege and what a responsibility!
多么了不起的特权，多么伟大的责任啊！
Of course, many of you already know that the line from college to career is unlikely to be perfectly straight.
当然，你们中的很多人已经知道从大学到职场的路线不可能是一帆风顺的。
It will have ups and downs, plenty of twists and turns, and probably a few of bumps along the way.
这一路几乎必然充满了起伏，有很多曲折，可能还会有一些颠簸。
But many of you will also realize that your starting point could not be better.
但是，你们中的很多人也已经意识到，你们的起点好得不能再好了。
This is why we are here today -- to celebrate the beginning of your journey, the starting point of a new adventure.
这就是我们今天在这里的原因，庆祝你们开始新的旅程，新的探险的起点。
It is a day of hope. It is a day of promise. It is a day of joy.
这是充满希望的一天。这是充满诺言的一天。也是充满快乐的一天。With this in mind, I would like to talk about three things that could, could help along the journey:
想到这一点，我想谈谈可能有助于这个旅程的三件事。
First, reinventing yourself and welcoming change and risks.
第一，重塑自己，欢迎改变和风险。
Second, standing up for your values and ideas.
第二，坚持自己的价值观和想法。
Third, encouraging transformational change in others.
第三，鼓励他人转型变革。
Now if you indulge me, I would like to introduce these points by briefly recounting personal experiences that have shaped my own life.
如果大家愿意，我想来介绍这几点，通过借鉴我自己一生中影响重大的个人经验。
Now of course, of course my experiences may not be the ultimate nuggets of wisdom.
当然，我的经验不可能是最高的智慧结晶。
But as Mark Twain once said: "It is better to have old second-hand diamonds than none at all."
但是正如马克·吐温说过，“拥有一颗二手的钻石总比什么都没有好。”
So I will try. And here is my first story -- about risk and reinvention.
所以我要试一下。这是我的第一个故事：关于重塑自己和冒险。
Now let me be clear about risks.
关于冒险，我要说得更清楚点。
Although I spend a lot of time in the air, I don't jump out of airplanes;
虽然我有很长时间都待在天上，但我不会跳飞机的。
And although I move a lot of money around, I don't hang out in casinos;
虽然我可以调动大量资金，但是我不会在赌场溜达。
Although I am French, I hardly drink any wine. So far, so boring.
虽然我是个法国人，但我几乎不喝葡萄酒。这么一看，我如此无趣。
But there is a pattern in my personal journey that I would describe as going from, from "cozy" to "crazy".
但是我的人生旅程中，有一种从舒适转到疯狂的模式。
As in: "Why would you give up your cozy life? Are you crazy?"
正如这个问题：“你为什么要放弃舒适的生活？你疯了吗？”
I heard the French version of that question 42 years ago,
42年前，我听到了这个问题的法文版本，
when I traded my cozy world in France for a new life with my American host family, my American school in Bethesda, Maryland.
当时我用法国安逸的生活换来了一个全新的生活，寄宿在一个美国家庭、在马里兰州贝塞斯达的学校学习。
I was 17, and I was recovering slowly from a profound emotional and cultural shock.
当时我17岁，我正在慢慢从巨大的情感和文化冲击中恢复过来。
And soon enough I was homesick and missing my family and friends.
很快我就想家了，想念我的家人和朋友。
But I was also incredibly excited to be exposed to new ideas, new language, a new ways of thinking.
但是我对可以接触到新思想，新语言和新思维方式也感到异常兴奋。
And I am forever indebted to those people who welcomed me and who allowed me to experience the most transformational year in my life.
我永远感激那些欢迎我、并让我经历我的一生中最具变革意义的一年的人们。
Let me give you another example "from cozy to crazy", and it happened right here in Chicago.
让我再举一个从舒适到疯狂的例子，它就发生在芝加哥。
In 1999, after years of studying at law school, hard work as a young, and then not so young lawyer,
1999年，在结束了法学院几年的学习并成为一名年轻的律师，并不是那么的年轻的律师之后，
my partners at Baker &amp; McKenzie elected me chairman of this global unique law firm.
我在贝克·麦坚时国际律师事务所的合伙人，将我选为这家全球知名法律公司的董事长。
Working and living here in Chicago allowed me to thrive as a lawyer,
在芝加哥的工作和生活使我得以成长为一名律师，
as a leader, and as a mother of two wonderful boys.
一名领导，两个出色孩子的母亲。
And I could not have made it without the support and tolerance of my family, they are here today,
没有家人的支持和宽容，我不可能做到这一点，他们今天就在这里，
and the help of my great colleagues and friends, some of whom are here today as well.
没有优秀的同事和朋友的帮助，我也不可能做到这一点，他们当中有些人今天也来到了这里。
But in 2005, I received a phone call, a bit like you, President.
但是在2005年，我接到了一通电话，这和你有点像，校长先生。
The call was from Paris, and it was the Prime Minister.
这通电话是来自巴黎的，是总理给我打的。
And he was asking me to join the French government as Trade Secretary.
他要求我加入法国政府，担任外贸部部长。
Now when your country calls you to public service, there is really one answer you can give.
当你的国家要求你参与公众服务的时候，你实际上能给出的答案只有一个。
So I gave up my cozy life as chairman, my wonderful expected retirement plan,
因此，我放弃了舒适的董事长生活，放弃了理想的退休计划，
packed my bag and flew immediately to Paris that very same day.
收拾行囊，就在当天立即飞往了巴黎。
And actually, in my haste, I managed to forget my glasses.
事实上，在匆忙中，我忘记了我的眼镜。
So for first few days in office, the newest French minister was blinking and squinting a lot!
所以在上任的头几天，这位新任的法国部长总是不停地眨眼和眯眼！
But going from "cozy" to "crazy" allowed me to move from the private sector to national public service,
但是从舒适到疯狂，使我从私营部门来到了国家公共服务部门，
and then to international public service; from France to the United States and to the world.
再到国际公共服务部门；从法国到美国再到全世界。
And one of the major lessons I have learned during that journey is this:
在这段旅程中，我学到的主要经验之一就是：
be prepared for change, be willing to take risks, be willing to take "smart risks",
为变化做好准备，愿意承担风险，愿意“明智地冒险”，
and don't ever be afraid of re-inventing yourself along the way.
不要害怕在这个过程中重新塑造自己。



京豆签到,自用,可N个京东账号
活动入口：各处的签到汇总
Node.JS专用
IOS软件用户请使用 https://raw.githubusercontent.com/NobyDa/Script/master/JD-DailyBonus/JD_DailyBonus.js
更新时间：2021-1-19
Modified From github https://github.com/ruicky/jd_sign_bot
 */
const $ = new Env('京豆签到');
const notify = $.isNode() ? require('./sendNotify') : '';
//Node.js用户请在jdCookie.js处填写京东ck;
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
const exec = require('child_process').execSync
const fs = require('fs')
const download = require('download');
let resultPath = "./result.txt";
let JD_DailyBonusPath = "./JD_DailyBonus.js";
let outPutUrl = './';
let NodeSet = 'CookieSet.json';
let cookiesArr = [], cookie = '';

if ($.isNode()) {
  Object.keys(jdCookieNode).forEach((item) => {
    cookiesArr.push(jdCookieNode[item])
  })
  if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => {};
}
!(async() => {
  if (!cookiesArr[0]) {
    $.msg($.name, '【提示】请先获取cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/bean/signIndex.action', {"open-url": "https://bean.m.jd.com/bean/signIndex.action"});
    return;
  }
  await requireConfig();
  // 下载最新代码
  await downFile();
  const content = await fs.readFileSync(JD_DailyBonusPath, 'utf8')
  for (let i =0; i < cookiesArr.length; i++) {
    cookie = cookiesArr[i];
    if (cookie) {
      $.UserName = decodeURIComponent(cookie.match(/pt_pin=(.+?);/) && cookie.match(/pt_pin=(.+?);/)[1])
      $.index = i + 1;
      $.nickName = '';
      await TotalBean();
      console.log(`*****************开始京东账号${$.index} ${$.nickName || $.UserName}京豆签到*******************\n`);
      console.log(`⚠️⚠️⚠️⚠️目前Bark APP推送通知消息对推送内容长度有限制，如推送通知中包含此推送方式脚本会默认转换成简洁内容推送 ⚠️⚠️⚠️⚠️\n`)
      await changeFile(content);
      await execSign();
    }
  }
})()
    .catch((e) => $.logErr(e))
    .finally(() => $.done())
async function execSign() {
  console.log(`\n开始执行脚本签到，请稍等`)
  try {
    // if (notify.SCKEY || notify.BARK_PUSH || notify.DD_BOT_TOKEN || (notify.TG_BOT_TOKEN && notify.TG_USER_ID) || notify.IGOT_PUSH_KEY || notify.QQ_SKEY) {
    //   await exec(`${process.execPath} ${JD_DailyBonusPath} >> ${resultPath}`);
    //   const notifyContent = await fs.readFileSync(resultPath, "utf8");
    //   console.log(`👇👇👇👇👇👇👇👇👇👇👇LOG记录👇👇👇👇👇👇👇👇👇👇👇\n${notifyContent}\n👆👆👆👆👆👆👆👆👆LOG记录👆👆👆👆👆👆👆👆👆👆👆`);
    // } else {
    //   console.log('没有提供通知推送，则打印脚本执行日志')
    //   await exec(`${process.execPath} ${JD_DailyBonusPath}`, { stdio: "inherit" });
    // }
    await exec(`${process.execPath} ${JD_DailyBonusPath} >> ${resultPath}`);
    const notifyContent = await fs.readFileSync(resultPath, "utf8");
    console.log(`👇👇👇👇👇👇👇👇👇👇👇LOG记录👇👇👇👇👇👇👇👇👇👇👇\n${notifyContent}\n👆👆👆👆👆👆👆👆👆LOG记录👆👆👆👆👆👆👆👆👆👆👆`);
    // await exec("node JD_DailyBonus.js", { stdio: "inherit" });
    // console.log('执行完毕', new Date(new Date().getTime() + 8 * 3600000).toLocaleDateString())
    //发送通知
    if ($.isNode()) {
      let notifyContent = "";
      let BarkContent = '';
      if (fs.existsSync(resultPath)) {
        notifyContent = await fs.readFileSync(resultPath, "utf8");
        const barkContentStart = notifyContent.indexOf('【签到概览】')
        const barkContentEnd = notifyContent.length;
        if (process.env.JD_BEAN_SIGN_STOP_NOTIFY === 'true') return
        if (process.env.BARK_PUSH || notify.BARK_PUSH) process.env.JD_BEAN_SIGN_NOTIFY_SIMPLE = 'true';
        if (process.env.JD_BEAN_SIGN_NOTIFY_SIMPLE === 'true') {
          if (barkContentStart > -1 && barkContentEnd > -1) {
            BarkContent = notifyContent.substring(barkContentStart, barkContentEnd);
          }
          BarkContent = BarkContent.split('\n\n')[0];
        } else {
          if (barkContentStart > -1 && barkContentEnd > -1) {
            BarkContent = notifyContent.substring(barkContentStart, barkContentEnd);
          }
        }
      }
      //不管哪个时区,这里得到的都是北京时间的时间戳;
      const UTC8 = new Date().getTime() + new Date().getTimezoneOffset()*60000 + 28800000;
      $.beanSignTime = timeFormat(UTC8);
      console.log(`脚本执行完毕时间：${$.beanSignTime}`)
      if (BarkContent) {
        await notify.sendNotify(`京豆签到 - 账号${$.index} - ${$.nickName || $.UserName}`, `【签到号 ${$.index}】: ${$.nickName || $.UserName}\n【签到时间】:  ${$.beanSignTime}\n${BarkContent}`);
      }
    }
    //运行完成后，删除下载的文件
    console.log('运行完成后，删除下载的文件\n')
    await deleteFile(resultPath);//删除result.txt
    await deleteFile(JD_DailyBonusPath);//删除JD_DailyBonus.js
    console.log(`*****************京东账号${$.index} ${$.nickName || $.UserName}京豆签到完成*******************\n`);
  } catch (e) {
    console.log("京东签到脚本执行异常:" + e);
  }
}
async function downFile () {
  let url = '';
  // if (process.env.CDN_JD_DAILYBONUS) {
  //   url = 'https://cdn.jsdelivr.net/gh/NobyDa/Script@master/JD-DailyBonus/JD_DailyBonus.js';
  // } else if (process.env.JD_COOKIE) {
  //   url = 'https://raw.githubusercontent.com/NobyDa/Script/master/JD-DailyBonus/JD_DailyBonus.js';
  // } else {
  //   url = 'https://cdn.jsdelivr.net/gh/NobyDa/Script@master/JD-DailyBonus/JD_DailyBonus.js';
  // }
  await downloadUrl();
  if ($.body) {
    url = 'https://raw.githubusercontent.com/NobyDa/Script/master/JD-DailyBonus/JD_DailyBonus.js';
  } else {
    url = 'https://cdn.jsdelivr.net/gh/NobyDa/Script@master/JD-DailyBonus/JD_DailyBonus.js';
  }
  try {
    const options = {}
    if (process.env.TG_PROXY_HOST && process.env.TG_PROXY_PORT) {
      const tunnel = require("tunnel");
      const agent = {
        https: tunnel.httpsOverHttp({
          proxy: {
            host: process.env.TG_PROXY_HOST,
            port: process.env.TG_PROXY_PORT * 1
          }
        })
      }
      Object.assign(options, { agent })
    }
    await download(url, outPutUrl, options);
    console.log('文件下载完毕');
  } catch (e) {
    console.log("文件下载异常:" + e);
  }
}

async function changeFile (content) {
  console.log(`开始替换变量`)
  let newContent = content.replace(/var Key = ''/, `var Key = '${cookie}'`);
  newContent = newContent.replace(/const NodeSet = 'CookieSet.json'/, `const NodeSet = '${NodeSet}'`)
  if (process.env.JD_BEAN_STOP && process.env.JD_BEAN_STOP !== '0') {
    newContent = newContent.replace(/var stop = '0'/, `var stop = '${process.env.JD_BEAN_STOP}'`);
  }
  const zone = new Date().getTimezoneOffset();
  if (zone === 0) {
    //此处针对UTC-0时区用户做的
    newContent = newContent.replace(/tm\s=.*/, `tm = new Date(new Date().toLocaleDateString()).getTime() - 28800000;`);
  }
  try {
    await fs.writeFileSync(JD_DailyBonusPath, newContent, 'utf8');
    console.log('替换变量完毕');
  } catch (e) {
    console.log("京东签到写入文件异常:" + e);
  }
}
async function deleteFile(path) {
  // 查看文件result.txt是否存在,如果存在,先删除
  const fileExists = await fs.existsSync(path);
  // console.log('fileExists', fileExists);
  if (fileExists) {
    const unlinkRes = await fs.unlinkSync(path);
    // console.log('unlinkRes', unlinkRes)
  }
}
function TotalBean() {
  return new Promise(async resolve => {
    const options = {
      "url": `https://wq.jd.com/user/info/QueryJDUserInfo?sceneval=2`,
      "headers": {
        "Accept": "application/json,text/plain, */*",
        "Content-Type": "application/x-www-form-urlencoded",
        "Accept-Encoding": "gzip, deflate, br",
        "Accept-Language": "zh-cn",
        "Connection": "keep-alive",
        "Cookie": cookie,
        "Referer": "https://wqs.jd.com/my/jingdou/my.shtml?sceneval=2",
        "User-Agent": $.isNode() ? (process.env.JD_USER_AGENT ? process.env.JD_USER_AGENT : (require('./USER_AGENTS').USER_AGENT)) : ($.getdata('JDUA') ? $.getdata('JDUA') : "jdapp;iPhone;9.2.2;14.2;%E4%BA%AC%E4%B8%9C/9.2.2 CFNetwork/1206 Darwin/20.1.0")
      }
    }
    $.post(options, (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`${$.name} API请求失败，请检查网路重试`)
        } else {
          if (data) {
            data = JSON.parse(data);
            if (data['retcode'] === 13) {
              $.isLogin = false; //cookie过期
              return
            }
            $.nickName = data['base'].nickname;
          } else {
            console.log(`京东服务器返回空数据`)
          }
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function downloadUrl(url = 'https://raw.githubusercontent.com/NobyDa/Script/master/JD-DailyBonus/JD_DailyBonus.js') {
  return new Promise(resolve => {
    const options = { url };
    if ($.isNode() && process.env.TG_PROXY_HOST && process.env.TG_PROXY_PORT) {
      const tunnel = require("tunnel");
      const agent = {
        https: tunnel.httpsOverHttp({
          proxy: {
            host: process.env.TG_PROXY_HOST,
            port: process.env.TG_PROXY_PORT * 1
          }
        })
      }
      Object.assign(options, { agent })
    }
    $.get(options, async (err, resp, data) => {
      try {
        if (err) {
          console.log(`${JSON.stringify(err)}`)
          console.log(`检测到您不能访问外网,将使用CDN下载JD_DailyBonus.js文件`)
        } else {
          $.body = data;
        }
      } catch (e) {
        $.logErr(e, resp)
      } finally {
        resolve();
      }
    })
  })
}
function requireConfig() {
  return new Promise(resolve => {
    const file = 'jd_bean_sign.js';
    fs.access(file, fs.constants.W_OK, (err) => {
      resultPath = err ? '/tmp/result.txt' : resultPath;
      JD_DailyBonusPath = err ? '/tmp/JD_DailyBonus.js' : JD_DailyBonusPath;
      outPutUrl = err ? '/tmp/' : outPutUrl;
      NodeSet = err ? '/tmp/CookieSet.json' : NodeSet;
      resolve()
    });
  })
}
function timeFormat(time) {
  let date;
  if (time) {
    date = new Date(time)
  } else {
    date = new Date();
  }
  return date.getFullYear() + '-' + ((date.getMonth() + 1) >= 10 ? (date.getMonth() + 1) : '0' + (date.getMonth() + 1)) + '-' + (date.getDate() >= 10 ? date.getDate() : '0' + date.getDate());
}
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
